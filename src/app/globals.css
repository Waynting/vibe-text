@tailwind base;
@tailwind components;
@tailwind utilities;

/* Vibe Text - 直式文字編輯器樣式 */

/* Theme variables */
:root {
  --bg-primary: #ffffff;
  --bg-secondary: #ffffff;
  --text-primary: #000000;
  --text-secondary: #666666;
  --text-placeholder: #999999;
  --border-color: #e0e0e0;
  --border-dark: #333333;
  --button-hover: #f8f8f8;
  --scrollbar: #e0e0e0;
  --scrollbar-hover: #cccccc;
}

/* Dark theme */
[data-theme="dark"] {
  --bg-primary: #000000;
  --bg-secondary: #000000;
  --text-primary: #ffffff;
  --text-secondary: #999999;
  --text-placeholder: #666666;
  --border-color: #333333;
  --border-dark: #cccccc;
  --button-hover: #1a1a1a;
  --scrollbar: #333333;
  --scrollbar-hover: #555555;
}

/* Ultra-minimalist CSS for vertical Chinese text editor */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: 'Songti SC', 'SimSun', 'Noto Serif CJK SC', serif;
  background: var(--bg-primary);
  color: var(--text-primary);
  transition: background-color 0.3s ease, color 0.3s ease;
}

/* Main container - full viewport */
@layer components {
  .app-container {
    @apply h-screen w-screen flex bg-[var(--bg-primary)];
  }

  /* Editor area - takes most of the screen */
  .editor-area {
    @apply flex-1 flex items-stretch justify-stretch p-0 mr-[200px] overflow-hidden;
  }

  /* Editor container with title and content */
  .editor-container {
    @apply w-full h-full flex flex-row-reverse overflow-x-auto overflow-y-auto;
  }

  /* 文字方向為 LTR 時，標題在左側 */
  .editor-container.direction-ltr {
    @apply flex-row; /* Title on the left */
  }

  /* Title area - Chinese composition style */
  .title-area {
    @apply flex-shrink-0 w-auto h-full px-[15px] py-[15px] flex items-start justify-center;
    padding-bottom: 40px;
  }

  .title-text {
    writing-mode: vertical-rl;
    text-orientation: upright;
    @apply font-songti text-[27px] font-normal leading-[1.8] tracking-[0.1em] text-[var(--text-primary)];
    /* Fix Chinese punctuation positioning in vertical text */
    text-combine-upright: none;
    font-feature-settings: 'vpal' 1, 'vkrn' 1, 'vchw' 1;
    padding: 15px;
  }

  /* Vertical divider line */
  .title-divider {
    @apply flex-shrink-0 w-px bg-[var(--border-dark)] self-stretch;
    height: calc(100% - 30px);
    margin: 15px 0;
  }

  /* Content area */
  .content-area {
    @apply flex-1 p-0 relative flex items-start h-screen;
  }

  /* Vertical text editor */
  .editor-vertical {
    writing-mode: vertical-rl;
    text-orientation: upright;
    @apply font-songti leading-[1.6] tracking-[0.02em] outline-none border-none bg-transparent text-[18px] text-[var(--text-primary)] w-full block m-0;
    height: 100vh;
    min-height: 100vh;
    max-height: 100vh;
    overflow-x: auto;
    overflow-y: hidden;
    padding: 15px 25px 8px 15px; /* 下方padding縮小到8px */
    /* Fix Chinese punctuation positioning in vertical text */
    text-combine-upright: none;
    font-feature-settings: 'vpal' 1, 'vkrn' 1, 'vchw' 1;
  }

  /* 文字方向變體 */
  .editor-vertical.direction-rtl {
    writing-mode: vertical-rl;
    text-orientation: upright;
    direction: ltr; /* 垂直文字在 RTL 模式下應該使用 ltr，讓文字從上往下排列 */
  }

  .editor-vertical.direction-ltr {
    writing-mode: vertical-lr;
    text-orientation: upright;
    direction: ltr;
  }

  /* Ultra-minimal toolbar - right side */
  .toolbar {
    @apply fixed top-0 right-0 w-[200px] h-screen bg-[var(--bg-primary)] border-l border-[var(--border-color)] p-[15px] flex flex-col gap-3 text-[17px] z-10 overflow-y-auto overflow-x-hidden;
  }
  

  /* Input fields */
  .input-field {
    @apply w-full py-2 px-0 border-none border-b border-[var(--border-color)] bg-transparent font-songti text-[17px] outline-none transition-colors duration-200;
  }

  .input-field:focus {
    @apply border-b-[var(--text-primary)];
  }

  .input-field::placeholder {
    @apply text-[var(--text-placeholder)];
  }

  /* Description textarea */
  .description-field {
    @apply resize-none text-[14px] leading-[1.4] py-2 px-2 border border-[var(--border-color)] rounded-[2px];
    min-height: 60px;
  }

  .description-field:focus {
    @apply border-[var(--text-primary)];
  }

  /* Labels */
  .label {
    @apply text-xs text-[var(--text-secondary)] mb-1 font-normal;
  }

  /* Buttons - ultra minimal */
  .btn {
    @apply bg-transparent border border-[var(--border-color)] py-2 px-3 font-songti text-xs cursor-pointer transition-all duration-200 text-[var(--text-primary)];
  }

  .btn:hover {
    @apply border-[var(--text-primary)];
  }

  .btn-primary {
    @apply border-[var(--text-primary)] bg-[var(--text-primary)] text-[var(--bg-primary)];
  }

  .btn-primary:hover {
    @apply border-[var(--bg-primary)] bg-[var(--text-primary)];
  }

  /* Word count display */
  .word-count {
    @apply text-xs text-[var(--text-secondary)] text-center py-2 border-t border-[var(--border-color)] mt-auto flex-shrink-0;
  }

  /* Button group */
  .btn-group {
    @apply flex flex-col gap-1;
  }

  .btn-group-row {
    @apply grid grid-cols-2 gap-1;
  }

  /* Section dividers */
  .section {
    @apply py-2 flex-shrink-0;
  }

  .section:not(:last-child) {
    @apply border-b border-[var(--border-color)] mb-2 pb-2;
  }

  .section-title {
    @apply text-xs text-[var(--text-primary)] mb-2 font-normal;
  }

  /* Theme toggle button */
  .theme-toggle {
    @apply w-full justify-center;
  }

  /* File path display */
  .file-path {
    @apply text-[11px] text-[var(--text-secondary)] py-1 break-all leading-[1.3] bg-black bg-opacity-5 px-2 py-[6px] rounded-[2px] font-mono;
  }

  [data-theme="dark"] .file-path {
    @apply bg-white bg-opacity-5;
  }
}

/* Force theme color inheritance */
[data-theme="light"] .editor-vertical,
[data-theme="light"] .title-text,
[data-theme="light"] .input-field,
[data-theme="light"] .description-field,
[data-theme="light"] .label,
[data-theme="light"] .section-title,
[data-theme="light"] .word-count {
  color: var(--text-primary) !important;
  background-color: transparent !important;
}

[data-theme="light"] .btn:not(.btn-primary) {
  color: var(--text-primary) !important;
  background-color: transparent !important;
}

[data-theme="dark"] .editor-vertical,
[data-theme="dark"] .title-text,
[data-theme="dark"] .input-field,
[data-theme="dark"] .description-field,
[data-theme="dark"] .label,
[data-theme="dark"] .section-title,
[data-theme="dark"] .word-count {
  color: var(--text-primary) !important;
  background-color: transparent !important;
}

[data-theme="dark"] .btn:not(.btn-primary) {
  color: var(--text-primary) !important;
  background-color: transparent !important;
}

[data-theme="dark"] .app-container,
[data-theme="dark"] .toolbar {
  background: var(--bg-primary) !important;
}

/* Selection styling - 修復異常反白 */
.editor-vertical::selection {
  background: rgba(0, 0, 0, 0.1);
  color: inherit;
}

.editor-vertical::-moz-selection {
  background: rgba(0, 0, 0, 0.1);
  color: inherit;
}

[data-theme="dark"] .editor-vertical::selection {
  background: rgba(255, 255, 255, 0.1);
  color: inherit;
}

[data-theme="dark"] .editor-vertical::-moz-selection {
  background: rgba(255, 255, 255, 0.1);
  color: inherit;
}

/* Mobile Responsive Design */
@media (max-width: 768px) {
  /* Hide sidebar edge toggle on mobile */
  .sidebar-toggle {
    @apply hidden !important;
  }
  
  /* Mobile toolbar - bottom slide-up */
  .toolbar {
    @apply w-full h-auto max-h-[50vh] border-l-0 border-t border-[var(--border-color)] bottom-0 top-auto left-0 right-0;
    transform: translateY(100%);
    transition: transform 0.3s ease;
  }
  
  .toolbar.open {
    transform: translateY(0);
  }
  
  .toolbar.collapsed {
    transform: translateY(100%);
  }
  
  /* Mobile toolbar close button - inside toolbar at top */
  .mobile-close-button {
    @apply w-full h-14 bg-transparent border-0 border-b border-[var(--border-color)] flex items-center justify-center text-lg cursor-pointer mb-6;
    color: var(--text-secondary);
    padding-bottom: 8px;
  }
  
  .mobile-close-button:hover {
    @apply bg-[var(--button-hover)];
  }
  
  /* Mobile toolbar open button - fixed bottom right when collapsed */
  .mobile-open-button {
    @apply fixed bottom-4 right-2 w-12 h-8 bg-[var(--bg-primary)] border border-[var(--border-color)] rounded-lg flex items-center justify-center text-lg z-20 cursor-pointer;
    box-shadow: -2px 0 6px rgba(0, 0, 0, 0.1);
  }
  
  /* Mobile editor - full width */
  .editor-vertical {
    @apply text-[16px] leading-[1.5];
    padding: 20px;
    width: 100vw;
  }
  
  /* Mobile editor area - full width */
  .editor-area {
    @apply mr-0 !important;
  }
  
  /* Mobile buttons - larger touch targets */
  .btn {
    @apply min-h-[44px] text-[16px] px-4;
  }
  
  /* Mobile input fields */
  .input-field {
    @apply text-[16px] py-3;
  }
  
  /* Mobile app container */
  .app-container {
    @apply pb-16;
  }
}

@media (max-width: 480px) {
  /* Extra small mobile adjustments */
  .editor-vertical {
    @apply text-[15px] pr-12;
    padding: 15px 50px 15px 15px;
  }
  
  .toolbar-toggle {
    @apply w-10 h-10 top-3 right-3 text-lg;
  }
  
  .toolbar {
    @apply p-3 gap-2;
  }
  
  .input-field {
    @apply text-[15px];
  }
  
  .btn {
    @apply text-[15px] min-h-[42px];
  }
}

/* Touch device optimizations */
@media (hover: none) and (pointer: coarse) {
  .btn:hover {
    @apply bg-transparent;
  }
  
  .btn:active {
    @apply bg-[var(--button-hover)];
  }
  
  /* Larger scrollbars for touch */
  .editor-vertical::-webkit-scrollbar {
    @apply w-3;
  }
  
  .toolbar::-webkit-scrollbar {
    @apply w-2;
  }
}